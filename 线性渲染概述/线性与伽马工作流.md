# 线性与Gamma工作流
Unity编辑器提供线性和Gamma工作流。线性工作流拥有一个交叉的颜色空间，可以让那些使用Gamma颜色空间制作的贴图能够正确而且精确的渲染在线性空间内。通过查看文档[<u>线性渲染概述</u>]()可以获得关于Gamma和线性空间的更多信息。

进一步的阅读，可以查看一下文档：
* [<u>线性渲染概述</u>]()阐述了线性和Gamma颜色空间的背景
* [<u>线性渲染使用Gamma颜色空间的图片</u>]()阐述了在线性工作流使用Gamma图片
* [<u>线性贴图</u>]()阐述了如何使用线性贴图

贴图被保存的格式更倾向于Gamma颜色空间，而着色器中更偏向线性颜色空间。同样的，当贴图在着色器中被采样时，基于Gamma的值会导致不正确的结果。为了克服这个，你可以通过设置使得RPG采样从Gamma采样调整到线性采样。这确保了线性工作流在着色器的输入和输出中的颜色空间正确，使得产生的结果正确。

为了指定Gamma或者线性工作流，*Edit->Project Settings*,然后选择 *Player* 分类，然后找到 *Other Settings* 打开 *Rendering* 然后更改 *Color Space* 从 *Linear* 到 *Gamma* ，这取决于你的偏好。

![线性空间配置图](https://docs.unity3d.com/uploads/Main/LinearRendering-ColorSpaceSetting.png)

# Gamma颜色空间工作流
尽管线性工作流确保了更精确的渲染，但是有些时候你还是需要Gamma工作流(例如，有些平台硬件只支持Gamma格式)。
为了做到这一点，设置 *Color space* 到 *Gamma* 在 *Player* Settings中。选择此选项后，渲染管道将使用存储它们的Gamma颜色空间中的所有颜色和纹理——当纹理在着色器中使用时，它们不会被删除gamma校正。

注意你可以选择绕过sRGB采样在Gamma颜色，通过取消选中sRGB在贴图属性中。

*Note:* 即使这些值在Gamma空间，所有的Unity编辑器着色器计算任然将他们的输入视为线性空间。为了确保
一个可以接受的结果，编辑器会做出一个调整去处理不匹配的格式当它从着色器输出到帧缓冲，而不对最终结果使用Gamma校正。

# 线性颜色空间工作流
使用线性颜色空间比使用Gamma颜色空间的渲染更为精确。
为了做到这一点，设置 *Color space* 到 *Linear* 在 *Player* Settings中。
你可以使用线性颜色空间不管你的贴图是使用线性或者Gamma颜色空间创建的。Gamma颜色空间的贴图在输入到线性空间的着色器程序的时候会删除他们的Gamma校正。

## 线性贴图
* 选择线性颜色空间中假定你的贴图在Gamma颜色空间中。Unity默认采用GPU's sRGB采样来解决Gamma到线性颜色空间的交叉使用。如果你的贴图使用的是线性空间创建的，你可以绕开sRGB采样。请看[<u>使用线性贴图</u>]()来查看更多的信息。

## Gamma贴图
* 从Gamma颜色空间转换到线性颜色空间需要一些调整。请看[<u>在线性空间中使用Gamma贴图</u>]()查看跟多的信息。

*Notes*
对于颜色而言这种转换是隐式的，因为Unity编辑器在传入到GPU之前已经转换这些值到浮点常数。当采样图片的时候，GPU自动的去除Gamma校正，把结果转换成线性空间。

这些输入随后被传入着色器，在线性空间中进行光照计算。当将结果值写入帧缓冲中时，要么直接Gamma校正，要么为以后留下Gamma校正，这取决于当前的渲染配置。例如：在HDR中，渲染结果保留在线性空间中，稍后进行Gamma校正。

# 线性和Gamma颜色空间的不同
当使用线性渲染时,光照方程的输入值不同于Gamma空间。这意味着不同的结果取决于颜色空间。例如，光照射到表面有着不同的响应曲线和图像效果也不同。

## 光衰减
距离的衰减和正常光照衰减有2种不同：
* 当在线性模式中渲染时，额外的Gamma校正会使得光的半径更大。
* 光的边缘更加的清晰，这更准确地模拟了表面的照明强度衰减。
![光衰减](https://docs.unity3d.com/uploads/Main/LinearRendering-LightingSphereLinearGamma.png)

## 线性光照强度反馈
当你使用的是Gamma渲染时，颜色和贴图在传入着色器的时候已经经过了Gamma校正。当在着色器中使用的时候，
高亮度的颜色实际上比线性亮度更大。这意味着光的强度增加，表面以一种非线性的方式增加亮度。这就导致光照在很多地方显得特别亮，使得很多模型和场景有一种褪色感。当你使用的是线性渲染时，表面的反馈根据光照强度的增加线性增加。这使得表面着色更加具有真实感，会使得比较好的一个颜色反馈。

一下3D头像展示了光照强度在Gamma和线性模式下的不同：
![光照强度的区别](https://docs.unity3d.com/uploads/Main/LinearRendering-Infinite3DHeadScan.jpg)

##线性与Gamma混合
当混合到帧缓存中时，混合发生在帧缓存的颜色空间中。
当你使用Gamma空间渲染时，非线性颜色混合在一起。这不是从算术上正确的混合颜色的方式，并且可以带来预料不到的结果，但这是在某些硬件上混合的唯一方式。
当你使用线性渲染，混合发生在线性颜色空间，这就是正确的算术方式并且给与精确的结果。
以下图示范了不同类型的混合：
![不同类型的混合](https://docs.unity3d.com/uploads/Main/LinearRendering-BlendingLinearGamma.jpg)
上图:在线性颜色空间中混合可以得到预期的结果
下图:在Gamma颜色空间中混合的结果过饱和并且过亮
